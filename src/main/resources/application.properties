# Database Connection Properties
spring.datasource.url=jdbc:postgresql://localhost:5432/rentacar
spring.datasource.username=postgres
spring.datasource.password=admin
spring.datasource.driver-class-name=org.postgresql.Driver

# JPA / Hibernate Properties
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true
logging.level.org.hibernate.SQL=DEBUG
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.properties.hibernate.schema_update.unique_constraint_strategy=DROP_RECREATE

# Enable PostGIS support
spring.jpa.properties.hibernate.jdbc.lob.non_contextual_creation=true
spring.jpa.properties.hibernate.spatial.enabled=true

# Server Configuration
server.port=8080

# Security
spring.security.user.name=admin
spring.security.user.password=admin

# Stripe API Keys
stripe.api.key=your_stripe_api_key_here
stripe.public.key=pk_test_51RBEWIFwQaj3rQJvqNbAr6GaPAxZeL8ViKCBNLjpGun2O6zK0uYI3bE9Hw5D7qXSFBRZopzxdwPBeOYGBwbKvDtU00heiXynFV

# File upload settings
spring.servlet.multipart.max-file-size=10MB
spring.servlet.multipart.max-request-size=10MB
spring.servlet.multipart.enabled=true
spring.servlet.multipart.resolve-lazily=true

# Create upload directories at startup
spring.web.resources.static-locations=classpath:/static/,file:./src/main/resources/static/

# Ensure static resources are properly handled
spring.mvc.static-path-pattern=/css/**,/js/**,/images/**
spring.web.resources.static-locations=classpath:/static/

# Spring MVC settings
spring.thymeleaf.cache=false
spring.thymeleaf.prefix=classpath:/templates/

# Set MIME type mapping explicitly
spring.web.resources.chain.strategy.content.enabled=true
spring.web.resources.chain.strategy.content.paths=/**

# Enable debug logging for upload issues
logging.level.org.springframework.web.multipart=DEBUG

# Rozwiązanie problemu cyklicznych zależności
spring.main.allow-circular-references=true

# Thymeleaf
spring.thymeleaf.cache=false
spring.thymeleaf.mode=HTML
spring.thymeleaf.encoding=UTF-8
spring.thymeleaf.prefix=classpath:/templates/
spring.thymeleaf.suffix=.html
spring.thymeleaf.check-template-location=true
spring.thymeleaf.servlet.content-type=text/html

# Uruchom skrypty inicjalizacyjne
spring.sql.init.mode=always

# Enable detailed error information
server.error.include-message=always
server.error.include-binding-errors=always
server.error.include-stacktrace=never
server.error.include-exception=true
server.error.path=/error
server.error.whitelabel.enabled=false

# Security debug logging
logging.level.org.springframework.security=INFO
logging.level.org.springframework.web=DEBUG
logging.level.org.thymeleaf=INFO

# Session configuration
server.servlet.session.timeout=30m
spring.session.store-type=none

# Allow bean definition overriding
spring.main.allow-bean-definition-overriding=true

# Error handling
server.error.whitelabel.enabled=false
server.error.include-stacktrace=never
server.error.include-message=always
server.error.include-binding-errors=always
server.error.include-exception=true

# Logging for troubleshooting
logging.level.org.springframework.security=INFO
logging.level.org.springframework.web=DEBUG
logging.level.com.rentacar=DEBUG

# Error handling for chunked encoding issues
server.tomcat.max-swallow-size=-1
server.tomcat.relaxed-query-chars=|,{,},[,]
server.tomcat.relaxed-path-chars=|,{,},[,]

# Chunked transfer settings
spring.mvc.async.request-timeout=30000

# Compression to reduce issues with large responses
server.compression.enabled=true
server.compression.min-response-size=1024
server.compression.mime-types=text/html,text/xml,text/plain,text/css,application/javascript,application/json

# Add logging for Tomcat to debug chunked encoding issues
logging.level.org.apache.coyote.http11=DEBUG
